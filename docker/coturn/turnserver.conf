# Coturn TURN/STUN Server Configuration for SimplyCaster
# This configuration provides NAT traversal for WebRTC connections

# Listening port for STUN/TURN (default: 3478)
listening-port=3478

# Alternative listening port for TLS (default: 5349)
tls-listening-port=5349

# Relay ports range for TURN relay (optimized for typical usage)
min-port=49152
max-port=49252

# Enable verbose logging (set to 0 for production)
verbose

# Log file location
log-file=/var/log/coturn/turnserver.log

# Enable STUN protocol support
stun-only=false

# Enable TURN protocol support
no-stun=false

# Use fingerprints in TURN messages
fingerprint

# Use long-term credential mechanism
lt-cred-mech

# Realm for TURN authentication (should match your domain)
realm=simplycast.local

# Static user credentials (for development - use shared secret in production)
# user=testuser:testpass

# Use shared secret for authentication (recommended for production)
use-auth-secret

# Shared secret for TURN authentication (will be set via environment variable)
# static-auth-secret will be set via TURN_SECRET env var

# Server name (for logging and identification)
server-name=coturn-simplycast

# Disable multicast aliases
no-multicast-peers

# Disable loopback peers
no-loopback-peers

# Enable mobility support
mobility

# Disable UDP relay endpoints
# no-udp-relay

# Disable TCP relay endpoints  
# no-tcp-relay

# Enable secure STUN
# secure-stun

# Certificate file for TLS (if using TURNS)
# cert=/etc/coturn/certs/cert.pem

# Private key file for TLS (if using TURNS)
# pkey=/etc/coturn/certs/privkey.pem

# Cipher list for TLS
# cipher-list="ECDH+AESGCM:ECDH+CHACHA20:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:RSA+AESGCM:RSA+AES:!aNULL:!MD5:!DSS"

# Enable prometheus metrics (if needed)
# prometheus

# Disable CLI (for security in production)
no-cli

# Disable RFC5780 support (for better compatibility)
no-rfc5780

# Enable origin check (for security)
# check-origin-consistency

# Banned peer IP ranges (RFC1918 private networks)
denied-peer-ip=10.0.0.0-10.255.255.255
denied-peer-ip=192.168.0.0-192.168.255.255
denied-peer-ip=172.16.0.0-172.31.255.255

# Allow loopback for development
# allowed-peer-ip=127.0.0.1

# Process limits
proc-user=turnserver
proc-group=turnserver

# Database configuration (if using database for users)
# psql-userdb="host=db dbname=simplycaster user=simplycaster password=password connect_timeout=30"

# Redis configuration (if using Redis for sessions)
# redis-userdb="ip=redis port=6379 dbname=0 password= connect_timeout=30"

# Quota and rate limiting
# total-quota=100
# user-quota=50
# max-bps=1000000

# Session timeout (in seconds)
stale-nonce=600

# Enable bandwidth per session
# bps-capacity=0

# Enable turn REST API
# web-admin
# web-admin-ip=127.0.0.1
# web-admin-port=8080

# Production security settings
# prod