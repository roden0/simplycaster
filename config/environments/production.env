# Production Environment Configuration
# SimplyCaster COTURN ICE Server Integration

# Environment
NODE_ENV=production
ENVIRONMENT=production

# Coturn Configuration
COTURN_HOST=turn.simplycast.com
COTURN_PORT=3478
COTURN_TURNS_PORT=5349
COTURN_REALM=simplycast.com
COTURN_SECRET=${COTURN_SECRET}
COTURN_USE_SSL=true
COTURN_EXTERNAL_IP=${COTURN_EXTERNAL_IP}
COTURN_TCP_FALLBACK_PORT=443
COTURN_MIN_PORT=49152
COTURN_MAX_PORT=65535
COTURN_LOG_LEVEL=2
COTURN_VERBOSITY=1

# ICE Server Configuration
TURN_CREDENTIAL_TTL=43200
ICE_CONNECTION_TIMEOUT=30000
ICE_GATHERING_TIMEOUT=10000
ICE_PRIORITY_HOST=126
ICE_PRIORITY_SRFLX=100
ICE_PRIORITY_RELAY=0

# Security Configuration (Strict for Production)
TURN_RATE_LIMITING_ENABLED=true
TURN_CREDENTIAL_RATE_LIMIT=10
TURN_CREDENTIAL_RATE_WINDOW=60
TURN_CONNECTION_RATE_LIMIT=20
TURN_CONNECTION_RATE_WINDOW=300

TURN_IP_RESTRICTIONS_ENABLED=true
TURN_ALLOWED_CIDRS=
TURN_BLOCKED_IPS=
TURN_MAX_CONNECTIONS_PER_IP=5

TURN_BANDWIDTH_QUOTAS_ENABLED=true
TURN_HOST_QUOTA_MBPS=50
TURN_GUEST_QUOTA_MBPS=20
TURN_QUOTA_WINDOW_SECONDS=3600

TURN_SECRET_ROTATION_ENABLED=true
TURN_SECRET_ROTATION_INTERVAL=168
TURN_SECRET_GRACE_PERIOD=24

# Monitoring Configuration
TURN_HEALTH_CHECKS_ENABLED=true
TURN_HEALTH_CHECK_INTERVAL=60
TURN_HEALTH_CHECK_TIMEOUT=15

TURN_METRICS_ENABLED=true
TURN_METRICS_RETENTION_HOURS=168
TURN_DETAILED_LOGGING=false

TURN_ALERTS_ENABLED=true
TURN_ERROR_RATE_THRESHOLD=2
TURN_RESPONSE_TIME_THRESHOLD=200
TURN_CONNECTION_FAILURE_THRESHOLD=2

# Master Key for Encryption (Set via secure environment)
TURN_MASTER_KEY=${TURN_MASTER_KEY}

# Audit Configuration
TURN_AUDIT_ENABLED=true
TURN_AUDIT_RETENTION_DAYS=90
TURN_AUDIT_LOG_SENSITIVE=false

# SSL/TLS Configuration
SSL_CERT_PATH=/etc/ssl/certs/simplycast.com.crt
SSL_KEY_PATH=/etc/ssl/private/simplycast.com.key
SSL_CA_PATH=/etc/ssl/certs/ca-bundle.crt

# Production Security Settings
PRODUCTION_SECURITY_HARDENING=true
PRODUCTION_MONITORING_ENABLED=true
PRODUCTION_BACKUP_ENABLED=true

# Load Balancer Configuration
LOAD_BALANCER_ENABLED=true
LOAD_BALANCER_HEALTH_CHECK_PATH=/api/webrtc/coturn/health
LOAD_BALANCER_TIMEOUT=30

# CDN Configuration
CDN_ENABLED=true
CDN_CACHE_TTL=3600

# Backup Configuration
BACKUP_ENABLED=true
BACKUP_RETENTION_DAYS=30
BACKUP_ENCRYPTION_ENABLED=true

# OpenTelemetry Configuration
OTEL_DENO=true
OTEL_SERVICE_NAME=simplycast
OTEL_SERVICE_VERSION=1.0.0
OTEL_ENVIRONMENT=production
OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-lgtm:4318
OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf

# Sampling Configuration (Lower sampling for production)
OTEL_TRACES_SAMPLER=traceidratio
OTEL_TRACES_SAMPLER_ARG=0.1
OTEL_METRICS_EXEMPLAR_FILTER=trace_based

# Resource Attributes
OTEL_RESOURCE_ATTRIBUTES=service.name=simplycast,service.version=1.0.0,deployment.environment=production

# Grafana Configuration (Use secrets in production)
GRAFANA_ADMIN_USER=${GRAFANA_ADMIN_USER:-admin}
GRAFANA_ADMIN_PASSWORD=${GRAFANA_ADMIN_PASSWORD}

# Data Retention (Longer for production)
LOKI_RETENTION_PERIOD=720h
TEMPO_RETENTION_PERIOD=720h
MIMIR_RETENTION_PERIOD=2160h