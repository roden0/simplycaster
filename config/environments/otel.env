# OpenTelemetry Configuration Reference
# This file documents all available OpenTelemetry environment variables
# Include this file or copy relevant sections to your environment-specific files

# ============================================================================
# CORE OPENTELEMETRY CONFIGURATION
# ============================================================================

# Enable OpenTelemetry automatic instrumentation in Deno
OTEL_DENO=true

# Service identification
OTEL_SERVICE_NAME=simplycast
OTEL_SERVICE_VERSION=1.0.0
OTEL_SERVICE_NAMESPACE=simplycast

# Environment identification
OTEL_ENVIRONMENT=development

# ============================================================================
# EXPORTER CONFIGURATION
# ============================================================================

# OTLP Exporter endpoint (where to send telemetry data)
OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-lgtm:4318

# OTLP Protocol (http/protobuf is recommended for performance)
OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf

# Optional: Separate endpoints for different signal types
# OTEL_EXPORTER_OTLP_TRACES_ENDPOINT=http://otel-lgtm:4318/v1/traces
# OTEL_EXPORTER_OTLP_METRICS_ENDPOINT=http://otel-lgtm:4318/v1/metrics
# OTEL_EXPORTER_OTLP_LOGS_ENDPOINT=http://otel-lgtm:4318/v1/logs

# Optional: Authentication headers
# OTEL_EXPORTER_OTLP_HEADERS=authorization=Bearer your-token

# Export timeout (milliseconds)
OTEL_EXPORTER_OTLP_TIMEOUT=10000

# ============================================================================
# SAMPLING CONFIGURATION
# ============================================================================

# Trace sampling strategy
# Options: always_on, always_off, traceidratio, parentbased_always_on, 
#          parentbased_always_off, parentbased_traceidratio
OTEL_TRACES_SAMPLER=traceidratio

# Sampling ratio (0.0 to 1.0)
# Development: 1.0 (100% sampling)
# Staging: 0.5 (50% sampling)  
# Production: 0.1 (10% sampling)
OTEL_TRACES_SAMPLER_ARG=1.0

# Metrics exemplar filter
# Options: always_on, always_off, trace_based
OTEL_METRICS_EXEMPLAR_FILTER=trace_based

# ============================================================================
# RESOURCE ATTRIBUTES
# ============================================================================

# Resource attributes identify the service and deployment
OTEL_RESOURCE_ATTRIBUTES=service.name=simplycast,service.version=1.0.0,deployment.environment=development,service.namespace=simplycast

# Additional resource attributes can be added:
# - deployment.environment: development, staging, production
# - service.instance.id: unique instance identifier
# - host.name: hostname
# - container.name: container name
# - k8s.pod.name: Kubernetes pod name
# - cloud.provider: aws, gcp, azure
# - cloud.region: deployment region

# ============================================================================
# INSTRUMENTATION CONFIGURATION
# ============================================================================

# Disable specific instrumentations if needed
# OTEL_NODE_DISABLED_INSTRUMENTATIONS=fs,dns

# Enable/disable specific signal types
OTEL_TRACES_EXPORTER=otlp
OTEL_METRICS_EXPORTER=otlp
OTEL_LOGS_EXPORTER=otlp

# Metric export interval (milliseconds)
OTEL_METRIC_EXPORT_INTERVAL=5000

# Batch span processor configuration
OTEL_BSP_MAX_EXPORT_BATCH_SIZE=512
OTEL_BSP_EXPORT_TIMEOUT=30000
OTEL_BSP_SCHEDULE_DELAY=5000
OTEL_BSP_MAX_QUEUE_SIZE=2048

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================

# OpenTelemetry SDK log level
# Options: NONE, ERROR, WARN, INFO, DEBUG, VERBOSE
OTEL_LOG_LEVEL=INFO

# Enable console logging of telemetry data (for debugging)
# OTEL_TRACES_EXPORTER=console,otlp
# OTEL_METRICS_EXPORTER=console,otlp

# ============================================================================
# PERFORMANCE AND RELIABILITY
# ============================================================================

# Enable/disable telemetry SDK
OTEL_SDK_DISABLED=false

# Propagators for trace context
# Options: tracecontext, baggage, b3, b3multi, jaeger, xray, ottrace
OTEL_PROPAGATORS=tracecontext,baggage

# Attribute limits
OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT=4096
OTEL_ATTRIBUTE_COUNT_LIMIT=128

# Span limits
OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT=4096
OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT=128
OTEL_SPAN_EVENT_COUNT_LIMIT=128
OTEL_SPAN_LINK_COUNT_LIMIT=128

# Event attribute limits
OTEL_EVENT_ATTRIBUTE_COUNT_LIMIT=128

# Link attribute limits
OTEL_LINK_ATTRIBUTE_COUNT_LIMIT=128

# ============================================================================
# SIMPLYCASTER-SPECIFIC CONFIGURATION
# ============================================================================

# Custom instrumentation flags
OTEL_SIMPLYCAST_WEBRTC_INSTRUMENTATION=true
OTEL_SIMPLYCAST_RECORDING_INSTRUMENTATION=true
OTEL_SIMPLYCAST_DATABASE_INSTRUMENTATION=true
OTEL_SIMPLYCAST_REDIS_INSTRUMENTATION=true
OTEL_SIMPLYCAST_AUTH_INSTRUMENTATION=true

# Performance monitoring thresholds
OTEL_SIMPLYCAST_SLOW_QUERY_THRESHOLD=1000
OTEL_SIMPLYCAST_SLOW_REQUEST_THRESHOLD=2000
OTEL_SIMPLYCAST_CACHE_MISS_ALERT_THRESHOLD=0.8

# ============================================================================
# OTEL-LGTM STACK CONFIGURATION
# ============================================================================

# Grafana Configuration
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin
GRAFANA_HTTP_PORT=3000

# Data retention policies
LOKI_RETENTION_PERIOD=24h
TEMPO_RETENTION_PERIOD=24h
MIMIR_RETENTION_PERIOD=168h

# Storage configuration
OTEL_LGTM_DATA_PATH=/var/lib/otel-lgtm
OTEL_LGTM_CONFIG_PATH=/etc/otel-lgtm

# ============================================================================
# ENVIRONMENT-SPECIFIC OVERRIDES
# ============================================================================

# Development Environment
# - High sampling rate (1.0)
# - Detailed logging enabled
# - Short retention periods
# - Console exporters for debugging

# Staging Environment  
# - Medium sampling rate (0.5)
# - Moderate logging
# - Medium retention periods
# - Production-like configuration

# Production Environment
# - Low sampling rate (0.1)
# - Minimal logging
# - Long retention periods
# - Optimized for performance