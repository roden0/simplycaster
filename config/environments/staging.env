# Staging Environment Configuration
# SimplyCaster COTURN ICE Server Integration

# Environment
NODE_ENV=staging
ENVIRONMENT=staging

# Coturn Configuration
COTURN_HOST=staging-turn.simplycast.local
COTURN_PORT=3478
COTURN_TURNS_PORT=5349
COTURN_REALM=staging.simplycast.local
COTURN_SECRET=${COTURN_SECRET}
COTURN_USE_SSL=true
COTURN_EXTERNAL_IP=${COTURN_EXTERNAL_IP}
COTURN_TCP_FALLBACK_PORT=443
COTURN_MIN_PORT=49152
COTURN_MAX_PORT=65535
COTURN_LOG_LEVEL=3
COTURN_VERBOSITY=2

# ICE Server Configuration
TURN_CREDENTIAL_TTL=43200
ICE_CONNECTION_TIMEOUT=30000
ICE_GATHERING_TIMEOUT=10000
ICE_PRIORITY_HOST=126
ICE_PRIORITY_SRFLX=100
ICE_PRIORITY_RELAY=0

# Security Configuration (Moderate for Staging)
TURN_RATE_LIMITING_ENABLED=true
TURN_CREDENTIAL_RATE_LIMIT=20
TURN_CREDENTIAL_RATE_WINDOW=60
TURN_CONNECTION_RATE_LIMIT=50
TURN_CONNECTION_RATE_WINDOW=300

TURN_IP_RESTRICTIONS_ENABLED=true
TURN_ALLOWED_CIDRS=10.0.0.0/8,172.16.0.0/12,192.168.0.0/16
TURN_BLOCKED_IPS=
TURN_MAX_CONNECTIONS_PER_IP=10

TURN_BANDWIDTH_QUOTAS_ENABLED=true
TURN_HOST_QUOTA_MBPS=75
TURN_GUEST_QUOTA_MBPS=30
TURN_QUOTA_WINDOW_SECONDS=3600

TURN_SECRET_ROTATION_ENABLED=true
TURN_SECRET_ROTATION_INTERVAL=168
TURN_SECRET_GRACE_PERIOD=24

# Monitoring Configuration
TURN_HEALTH_CHECKS_ENABLED=true
TURN_HEALTH_CHECK_INTERVAL=30
TURN_HEALTH_CHECK_TIMEOUT=10

TURN_METRICS_ENABLED=true
TURN_METRICS_RETENTION_HOURS=72
TURN_DETAILED_LOGGING=true

TURN_ALERTS_ENABLED=true
TURN_ERROR_RATE_THRESHOLD=5
TURN_RESPONSE_TIME_THRESHOLD=500
TURN_CONNECTION_FAILURE_THRESHOLD=3

# Master Key for Encryption (Set via environment)
TURN_MASTER_KEY=${TURN_MASTER_KEY}

# Audit Configuration
TURN_AUDIT_ENABLED=true
TURN_AUDIT_RETENTION_DAYS=60
TURN_AUDIT_LOG_SENSITIVE=false

# SSL/TLS Configuration
SSL_CERT_PATH=/etc/ssl/certs/staging.simplycast.local.crt
SSL_KEY_PATH=/etc/ssl/private/staging.simplycast.local.key
SSL_CA_PATH=/etc/ssl/certs/ca-bundle.crt

# Additional Staging Settings
STAGING_DEBUG_MODE=true
STAGING_PERFORMANCE_MONITORING=true

# OpenTelemetry Configuration
OTEL_DENO=true
OTEL_SERVICE_NAME=simplycast
OTEL_SERVICE_VERSION=1.0.0
OTEL_ENVIRONMENT=staging
OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-lgtm:4318
OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf

# Sampling Configuration (Moderate sampling for staging)
OTEL_TRACES_SAMPLER=traceidratio
OTEL_TRACES_SAMPLER_ARG=0.5
OTEL_METRICS_EXEMPLAR_FILTER=trace_based

# Resource Attributes
OTEL_RESOURCE_ATTRIBUTES=service.name=simplycast,service.version=1.0.0,deployment.environment=staging

# Grafana Configuration
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=${GRAFANA_ADMIN_PASSWORD:-staging-admin}

# Data Retention (Medium for staging)
LOKI_RETENTION_PERIOD=168h
TEMPO_RETENTION_PERIOD=168h
MIMIR_RETENTION_PERIOD=720h